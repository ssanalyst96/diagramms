@startuml
title Процесс обработки файла и формирования отчета

|Пользователь|
start
:Загружает файл в систему;
|Система|
:Проверяет файл на валидность;

if (Файл валиден?) then (Да)
  :Формирует отчет;
  :Предоставляет выбор формата (PDF/Excel);
  |Пользователь|
  :Выбирает формат;
  |Система|
  :Генерирует отчет в выбранном формате;
  
  fork
    :Отправляет отчет менеджеру;
  fork again
    :Загружает отчет в облачное хранилище;
  end fork
  :Отчет успешно обработан;
  
else (Нет)
  :Подсвечивает ошибки в файле;
  :Предлагает исправление (автоматическое/ручное);

  |Пользователь|
  if (Выбрано автоматическое исправление?) then (Да)
    |Система|
    partition "Автоматическое исправление данных" {
      :Анализ ошибок;
      :Коррекция данных по шаблону;
      :Проверка исправленного файла;
    }
  else (Нет)
    |Пользователь|
    :Вносит исправления вручную;
    |Система|
    :Проверяет исправленный файл;
    
    if (Файл исправлен?) then (Да)
      :Файл исправлен;
    else (Нет)
      :Завершить процесс с ошибкой;
      stop;
    endif
  endif
endif

stop
@enduml