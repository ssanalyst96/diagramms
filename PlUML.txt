title Процесс применения промокода при оплате заказа

participant Пользователь
participant Экран оплаты
participant Сервис промокодов

autonumber 
Пользователь -> Экран оплаты: добавить промокод
activate Экран оплаты
Экран оплаты --> Пользователь: открыть поле ввода промокода
deactivate Экран оплаты
Пользователь -> Экран оплаты: ввести промокод
activate Экран оплаты
Пользователь -> Экран оплаты: проверить промокод
 Экран оплаты -> Сервис промокодов: отправить промокод для проверки
 activate Сервис промокодов
 Сервис промокодов --> Сервис промокодов: проверка промокода
 
 
 alt Промокод не найден
 Сервис промокодов --> Экран оплаты: возврат ошибки
 Экран оплаты --> Пользователь: отобразить ошибку "промокод не найден"
 
 alt Промокод просрочен или перестал действовать
 Сервис промокодов --> Сервис промокодов: промокод найден
 Сервис промокодов --> Экран оплаты: промокод не валиден
 Экран оплаты --> Пользователь: отобразить ошибку "промокод недействителен"
 end
 
 end

Сервис промокодов --> Сервис промокодов: промокод найден
Сервис промокодов --> Экран оплаты: успешный ответ, применить скидку
deactivate Сервис промокодов
Экран оплаты --> Пользователь: скидка применена
Пользователь -> Экран оплаты: оплатить со скидкой (см. диаграмма оплаты)
Экран оплаты -> Сервис промокодов: промокод деактивирован
Экран оплаты --> Пользователь: отобразить результат оплаты
